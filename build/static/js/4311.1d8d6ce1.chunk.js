"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4311],{4445:function(e,s,l){l.d(s,{s:function(){return a}});const a=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='272 434.744 272 209.176 240 209.176 240 434.744 188.118 382.862 165.49 405.489 256 496 346.51 405.489 323.882 382.862 272 434.744' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M400,161.176c0-79.4-64.6-144-144-144s-144,64.6-144,144a96,96,0,0,0,0,192h80v-32H112a64,64,0,0,1,0-128h32v-32a112,112,0,0,1,224,0v32h32a64,64,0,0,1,0,128H320v32h80a96,96,0,0,0,0-192Z' class='ci-primary'/>"]},14311:function(e,s,l){l.r(s),l.d(s,{default:function(){return N}});var a=l(9950),t=l(26910),i=l(11031),c=l(49911),d=l(81949),n=l(23286);const r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M426.072,86.928A238.75,238.75,0,0,0,88.428,424.572,238.75,238.75,0,0,0,426.072,86.928ZM257.25,462.5c-114,0-206.75-92.748-206.75-206.75S143.248,49,257.25,49,464,141.748,464,255.75,371.252,462.5,257.25,462.5Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='221.27 305.808 147.857 232.396 125.23 255.023 221.27 351.063 388.77 183.564 366.142 160.937 221.27 305.808' class='ci-primary'/>"];var o=l(50997);const m=["512 512","<rect width='368' height='32' x='72' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"];var x=l(10113);const h=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='359.873 121.377 337.246 144.004 433.243 240.001 16 240.001 16 240.002 16 272.001 16 272.002 433.24 272.002 337.246 367.996 359.873 390.623 494.498 256 359.873 121.377' class='ci-primary'/>"];var u=l(44429),p=l(4445),b=l(62146),j=l(66187),f=l(44414);b.t1.register(b.Bs,b.m_,b.s$,b.PP,b.kc);var v=function(e){let{agents:s,agentStatuses:l,callStats:t,breakTimeAgentDetails:i=[],totalBreakTime:b=0}=e;const[v,y]=(0,a.useState)("today"),[g,C]=(0,a.useState)(""),[N,w]=(0,a.useState)(""),S=(()=>{if(l&&(l.active||l.deactive||l.break))return{active:l.active,deactive:l.deactive,break:l.break,total:l.active+l.deactive+l.break};const e=s||0,a=Math.floor(.6*e),t=Math.floor(.25*e);return{active:a,deactive:t,break:e-a-t,total:e}})(),A=(()=>{if(t&&void 0!==t.totalCalls)return t;switch(v){case"today":default:return{totalCalls:850,liveCalls:12,outboundCalls:420,inboundCalls:380,missedCalls:32,rejectedCalls:18,callsPerDay:850};case"7days":return{totalCalls:5250,liveCalls:8,outboundCalls:2800,inboundCalls:2200,missedCalls:180,rejectedCalls:70,callsPerDay:750};case"month":return{totalCalls:18500,liveCalls:15,outboundCalls:9800,inboundCalls:8200,missedCalls:420,rejectedCalls:280,callsPerDay:617};case"custom":return{totalCalls:1200,liveCalls:5,outboundCalls:650,inboundCalls:520,missedCalls:45,rejectedCalls:25,callsPerDay:400}}})(),k=e=>{const s=(new Date).toISOString().split("T")[0],l="today"===v?"Current Day":"7days"===v?"7 Days":"month"===v?"Month":"Custom Range",a=[["Call Statistics Report"],["Generated on:",(new Date).toLocaleString()],["Period:",l],[""],["Call Type","Count","Percentage"],["Total Calls",A.totalCalls,"100%"],["Live Calls",A.liveCalls,(A.liveCalls/A.totalCalls*100).toFixed(1)+"%"],["Outbound Calls",A.outboundCalls,(A.outboundCalls/A.totalCalls*100).toFixed(1)+"%"],["Inbound Calls",A.inboundCalls,(A.inboundCalls/A.totalCalls*100).toFixed(1)+"%"],["Missed Calls",A.missedCalls,(A.missedCalls/A.totalCalls*100).toFixed(1)+"%"],["Rejected Calls",A.rejectedCalls,(A.rejectedCalls/A.totalCalls*100).toFixed(1)+"%"],["Calls per Day",A.callsPerDay,"-"]];if("csv"===e){const e=a.map(e=>e.join(",")).join("\n"),l=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),i=URL.createObjectURL(l);t.setAttribute("href",i),t.setAttribute("download","call_statistics_".concat(s,".csv")),document.body.appendChild(t),t.click(),document.body.removeChild(t)}else if("xlsx"===e){const e=a.map(e=>e.join("\t")).join("\n"),l=new Blob([e],{type:"application/vnd.ms-excel;charset=utf-8;"}),t=document.createElement("a"),i=URL.createObjectURL(l);t.setAttribute("href",i),t.setAttribute("download","call_statistics_".concat(s,".xls")),document.body.appendChild(t),t.click(),document.body.removeChild(t)}},B={labels:["Live Calls","Outbound Calls","Inbound Calls","Missed Calls","Rejected Calls"],datasets:[{data:[Math.max(A.liveCalls,0),Math.max(A.outboundCalls,0),Math.max(A.inboundCalls,0),Math.max(A.missedCalls,0),Math.max(A.rejectedCalls,0)],backgroundColor:["#2eb85c","#f9b115","#39f","#e55353","#636f83"],borderWidth:2,borderColor:"#fff"}]};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(c.sK,{className:"mb-4",children:[(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #6f42c1"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{style:{backgroundColor:"rgba(111, 66, 193, 0.1)"},className:"p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:n.g,size:"xl",style:{color:"#6f42c1"}})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold",style:{color:"#6f42c1"},children:s||0}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Total Agents"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #28a745"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-success bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:r,size:"xl",className:"text-success"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-success",children:S.active}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Active Agents"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #dc3545"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-danger bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:o.X,size:"xl",className:"text-danger"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-danger",children:S.deactive}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Inactive Agents"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #ffc107"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-warning bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:m,size:"xl",className:"text-warning"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-warning",children:S.break}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Break Time Agents"})]})]})})})]}),(0,f.jsxs)(c.sK,{className:"mb-4",children:[(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #321fdb"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-primary bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:x.L,size:"xl",className:"text-primary"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-primary",children:A.totalCalls}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Total Calls"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #2eb85c"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-success bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:r,size:"xl",className:"text-success"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-success",children:A.liveCalls}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Live Calls"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #f9b115"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-warning bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:h,size:"xl",className:"text-warning"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-warning",children:A.outboundCalls}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Outbound Calls"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #20c997"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-success bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:u.H,size:"xl",className:"text-success"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-success",children:A.callsPerDay}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Calls per Day"})]})]})})})]}),(0,f.jsxs)(c.sK,{className:"mb-4",children:[(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #39f"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-info bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:x.L,size:"xl",className:"text-info"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-info",children:A.inboundCalls}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Inbound Calls"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #e55353"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-danger bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:m,size:"xl",className:"text-danger"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-danger",children:A.missedCalls}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Missed Calls"})]})]})})}),(0,f.jsx)(c.UF,{sm:6,lg:3,children:(0,f.jsx)(c.E$,{className:"mb-4",style:{borderLeft:"4px solid #636f83"},children:(0,f.jsxs)(c.W6,{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"me-3",children:(0,f.jsx)("div",{className:"bg-secondary bg-opacity-10 p-3 rounded",children:(0,f.jsx)(d.Ay,{icon:o.X,size:"xl",className:"text-secondary"})})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"fs-6 fw-semibold text-secondary",children:A.rejectedCalls}),(0,f.jsx)("div",{className:"text-medium-emphasis text-uppercase fw-semibold small",children:"Rejected Calls"})]})]})})})]}),(0,f.jsx)(c.sK,{className:"mb-4",children:(0,f.jsx)(c.UF,{lg:12,children:(0,f.jsxs)(c.E$,{children:[(0,f.jsx)(c.V0,{children:(0,f.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,f.jsx)("h5",{className:"mb-0",children:"Call Statistics Overview"}),(0,f.jsxs)("div",{className:"d-flex gap-2",children:[(0,f.jsxs)(c.Q_,{color:"outline-primary",size:"sm",onClick:()=>k("csv"),title:"Download as CSV",children:[(0,f.jsx)(d.Ay,{icon:p.s,className:"me-1"}),"CSV"]}),(0,f.jsxs)(c.Q_,{color:"outline-success",size:"sm",onClick:()=>k("xlsx"),title:"Download as Excel",children:[(0,f.jsx)(d.Ay,{icon:p.s,className:"me-1"}),"Excel"]})]})]})}),(0,f.jsxs)(c.W6,{children:[(0,f.jsxs)(c.sK,{className:"mb-4",children:[(0,f.jsx)(c.UF,{md:3,children:(0,f.jsxs)(c.MT,{value:v,onChange:e=>{const s=e.target.value;y(s),"function"===typeof window.fetchCallStatistics&&window.fetchCallStatistics(s)},"aria-label":"Time Filter",children:[(0,f.jsx)("option",{value:"today",children:"Current Day"}),(0,f.jsx)("option",{value:"7days",children:"7 Days"}),(0,f.jsx)("option",{value:"month",children:"Month"}),(0,f.jsx)("option",{value:"custom",children:"Custom"})]})}),"custom"===v&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.UF,{md:3,children:(0,f.jsx)(c.BG,{children:(0,f.jsx)(c.OG,{type:"date",value:g,onChange:e=>C(e.target.value),placeholder:"Start Date"})})}),(0,f.jsx)(c.UF,{md:3,children:(0,f.jsx)(c.BG,{children:(0,f.jsx)(c.OG,{type:"date",value:N,onChange:e=>w(e.target.value),placeholder:"End Date"})})}),(0,f.jsx)(c.UF,{md:3,children:(0,f.jsx)(c.Q_,{color:"primary",onClick:()=>{"function"===typeof window.fetchCallStatistics&&window.fetchCallStatistics("custom",g,N)},children:"Apply"})})]})]}),(0,f.jsxs)(c.sK,{children:[(0,f.jsx)(c.UF,{lg:4,children:(0,f.jsx)(c.E$,{className:"h-100",children:(0,f.jsxs)(c.W6,{className:"text-center",children:[(0,f.jsx)("h6",{className:"mb-3",children:"Agent Status Distribution"}),(0,f.jsxs)("div",{style:{height:"250px",position:"relative"},children:[(0,f.jsx)(j.nu,{data:{labels:["Active","Deactive","Break"],datasets:[{data:[S.active,S.deactive,S.break],backgroundColor:["#28a745","#dc3545","#ffc107"],borderWidth:2,borderColor:"#fff",cutout:"70%"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{padding:10,usePointStyle:!0,font:{size:10}}},tooltip:{callbacks:{label:function(e){const s=e.label||"",l=e.parsed||0;return"".concat(s,": ").concat(l," agents")}}}}}}),(0,f.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[(0,f.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#2c3e50"},children:"Total"}),(0,f.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#2c3e50"},children:"Agents"}),(0,f.jsx)("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#2c3e50",marginTop:"3px"},children:S.total})]})]}),(0,f.jsx)("div",{style:{marginTop:"15px"},children:(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",textAlign:"center"},children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{style:{fontSize:"9px",fontWeight:"600",color:"#28a745",textTransform:"uppercase",letterSpacing:"1px"},children:"ACTIVE"}),(0,f.jsx)("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#28a745"},children:S.active})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{style:{fontSize:"9px",fontWeight:"600",color:"#dc3545",textTransform:"uppercase",letterSpacing:"1px"},children:"DEACTIVE"}),(0,f.jsx)("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#dc3545"},children:S.deactive})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{style:{fontSize:"9px",fontWeight:"600",color:"#ffc107",textTransform:"uppercase",letterSpacing:"1px"},children:"BREAK"}),(0,f.jsx)("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#ffc107"},children:S.break})]})]})})]})})}),(0,f.jsx)(c.UF,{lg:5,children:(0,f.jsx)(c.E$,{className:"h-100",children:(0,f.jsxs)(c.W6,{className:"text-center",children:[(0,f.jsx)("h6",{className:"mb-3",children:"Call Type Distribution"}),(0,f.jsx)("div",{style:{height:"300px",position:"relative"},children:(0,f.jsx)(j.Fq,{data:B,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:10,usePointStyle:!0,font:{size:10}}},tooltip:{callbacks:{label:function(e){const s=e.label||"",l=e.parsed||0,a=(l/e.dataset.data.reduce((e,s)=>e+s,0)*100).toFixed(1);return"".concat(s,": ").concat(l," (").concat(a,"%)")}}}}}})})]})})}),(0,f.jsx)(c.UF,{lg:3,children:(0,f.jsx)(c.E$,{className:"h-100",children:(0,f.jsxs)(c.W6,{children:[(0,f.jsx)("h6",{className:"mb-3 text-center",children:"Call Summary"}),(0,f.jsxs)("div",{className:"chart-summary",children:[(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Total Calls:"})," ",A.totalCalls]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Live Calls:"})," ",A.liveCalls]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Outbound Calls:"})," ",A.outboundCalls]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Inbound Calls:"})," ",A.inboundCalls]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Missed Calls:"})," ",A.missedCalls]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Rejected Calls:"})," ",A.rejectedCalls]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{className:"fw-semibold",children:"Calls per Day:"})," ",A.callsPerDay]})]})]})})})]})]})]})})}),S.break>0&&(0,f.jsx)(c.sK,{className:"mb-4",children:(0,f.jsx)(c.UF,{lg:12,children:(0,f.jsxs)(c.E$,{children:[(0,f.jsx)(c.V0,{children:(0,f.jsxs)("h5",{className:"mb-0",children:[(0,f.jsx)(d.Ay,{icon:m,className:"text-warning me-2"}),"Break Time Agents (",S.break,")"]})}),(0,f.jsx)(c.W6,{children:(0,f.jsx)(c.sK,{children:(0,f.jsxs)(c.UF,{children:[(0,f.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,f.jsx)("div",{className:"bg-warning bg-opacity-10 p-2 me-3 rounded",children:(0,f.jsx)(d.Ay,{icon:m,size:"lg",className:"text-warning"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h6",{className:"mb-0",children:"Current agents on break"}),(0,f.jsx)("small",{className:"text-muted",children:"Data refreshes automatically every minute"})]})]}),i&&i.length>0?(0,f.jsxs)(c._v,{small:!0,hover:!0,responsive:!0,children:[(0,f.jsx)(c.wV,{children:(0,f.jsxs)(c.YI,{children:[(0,f.jsx)(c.$s,{children:"Agent"}),(0,f.jsx)(c.$s,{children:"Start Time"}),(0,f.jsx)(c.$s,{children:"Duration"}),(0,f.jsx)(c.$s,{children:"Status"})]})}),(0,f.jsxs)(c.jS,{children:[i.slice(0,5).map((e,s)=>(0,f.jsxs)(c.YI,{children:[(0,f.jsx)(c.cC,{children:e.name}),(0,f.jsx)(c.cC,{children:e.startTime?new Date(e.startTime).toLocaleTimeString():"N/A"}),(0,f.jsx)(c.cC,{children:void 0!==e.duration?"".concat(e.duration," min"):"N/A"}),(0,f.jsx)(c.cC,{children:(0,f.jsx)(c.$X,{color:"warning",children:"On Break"})})]},e.id||s)),i.length>5&&(0,f.jsx)(c.YI,{children:(0,f.jsx)(c.cC,{colSpan:4,className:"text-center",children:(0,f.jsxs)("small",{className:"text-muted",children:["+ ",i.length-5," more agents on break"]})})})]})]}):(0,f.jsx)("div",{className:"text-center py-3",children:(0,f.jsxs)("p",{className:"mb-0",children:[S.break," agent(s) currently on break"]})})]})})})]})})})]})},y=l(2720);const g=e=>{const s=(0,y.vo)();return"".concat(s).concat(e.startsWith("/")?"":"/").concat(e)},C=(0,i.g)();var N=()=>{const[e,s]=(0,a.useState)({}),[l,i]=(0,a.useState)(0),[c,d]=(0,a.useState)({active:0,deactive:0,break:0});(0,a.useEffect)(()=>{if(!C||null===e||void 0===e||!e.businessId)return;(async()=>{try{const s=await t.A.get(g("/api/branch/".concat(e.businessId,"/branches")),{headers:{Authorization:"Bearer ".concat(C)}});if(s.data&&s.data.success&&Array.isArray(s.data.data)){const e=s.data.data;console.log("Fetched agent list:",e),i(e.length);let l=0,a=0;e.forEach(e=>{const s=e.user&&e.user.status?e.user.status.toLowerCase():"";"active"===s?l++:"inactive"===s&&a++}),d(e=>({...e,active:l,deactive:a}))}else i(0),d(e=>({...e,active:0,deactive:0}))}catch(s){i(0),d(e=>({...e,active:0,deactive:0}))}})()},[C,null===e||void 0===e?void 0:e.businessId]);const[n,r]=(0,a.useState)({totalCalls:0,liveCalls:0,outboundCalls:0,callsPerDay:0,inboundCalls:0,missedCalls:0,rejectedCalls:0}),[o,m]=(0,a.useState)([]);(0,a.useEffect)(()=>{(async()=>{if(C&&null!==e&&void 0!==e&&e.businessId)try{const s=await t.A.get(g("/api/call-logs/today?businessId=".concat(e.businessId)),{headers:{Authorization:"Bearer ".concat(C)}});if(s.data&&s.data.success&&s.data.statistics){const e=s.data.statistics||{};m([]),r({totalCalls:e.totalCalls||0,liveCalls:0,outboundCalls:e.callsByType&&e.callsByType.outbound||0,callsPerDay:e.totalCalls||0,inboundCalls:e.callsByType&&e.callsByType.inbound||0,missedCalls:e.callsByStatus&&e.callsByStatus.missed||0,rejectedCalls:e.callsByStatus&&e.callsByStatus.rejected||0})}else m([]),r({totalCalls:0,liveCalls:0,outboundCalls:0,callsPerDay:0,inboundCalls:0,missedCalls:0,rejectedCalls:0})}catch(s){m([]),r({totalCalls:0,liveCalls:0,outboundCalls:0,callsPerDay:0,inboundCalls:0,missedCalls:0,rejectedCalls:0})}})()},[C,null===e||void 0===e?void 0:e.businessId]);const[x,h]=(0,a.useState)(0),[u,p]=(0,a.useState)([]),[b,j]=(0,a.useState)(0),[y,N]=(0,a.useState)([]),[w,S]=(0,a.useState)(1),A=Math.ceil(y.length/10),k=y.slice(10*(w-1),10*w);(0,a.useEffect)(()=>{(async()=>{if(C&&null!==e&&void 0!==e&&e.businessId)try{const s=await t.A.get(g("/api/call-uses/today?businessId=".concat(e.businessId)),{headers:{Authorization:"Bearer ".concat(C)}});if(s.data&&s.data.success&&Array.isArray(s.data.perUserNumber)){const e=s.data.date||null,l=s.data.perUserNumber.map(s=>({...s,apiDate:e}));N(l)}else N([])}catch(s){N([])}})()},[C,null===e||void 0===e?void 0:e.businessId]),(0,a.useEffect)(()=>{if(!C)return;(async()=>{try{const e=await t.A.get(g("/api/v1/user/details"),{headers:{Accept:"*/*","Accept-Language":"en-US,en;q=0.9",Authorization:"Bearer ".concat(C),"Cache-Control":"no-cache,no-store",Connection:"keep-alive",Expires:"0",Pragma:"no-cache","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-origin"}});e.data&&e.data.user?s(e.data.user):s({role:"business_admin",name:"Admin"})}catch(e){console.warn("User API failed, using fallback:",e.message),s({role:"business_admin",name:"Admin"})}})()},[C]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{style:{margin:"1rem 0"},children:(0,f.jsx)("h1",{className:"contact-list-title",children:"Dashboard"})}),(0,f.jsx)(v,{agents:l,agentStatuses:c,callStats:n,breakTimeAgentDetails:u,totalBreakTime:b}),(0,f.jsxs)("div",{style:{margin:"2rem 0"},children:[(0,f.jsx)("h4",{children:"Call Uses"}),(0,f.jsx)("div",{style:{overflowX:"auto"},children:(0,f.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",background:"#fff",borderRadius:8,boxShadow:"0 2px 8px #e5e7eb"},children:[(0,f.jsx)("thead",{style:{background:"#f3f4f6"},children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Agent"}),(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Number"}),(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Outbound"}),(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Inbound"}),(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Missed"}),(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Hang"}),(0,f.jsx)("th",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:"Last Updated"})]})}),(0,f.jsx)("tbody",{children:0===k.length?(0,f.jsx)("tr",{children:(0,f.jsx)("td",{colSpan:7,style:{textAlign:"center",padding:20},children:"No call usage data found."})}):k.map((e,s)=>{var l,a,t,i;return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:e.name||e.userEmail||e.userId||"-"}),(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:e.virtualNumber||e.numberId&&e.numberId.number||"-"}),(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:null!==(a=null!==(t=e.callsByType&&e.callsByType.outbound)&&void 0!==t?t:e.totalCalls)&&void 0!==a?a:0}),(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:null!==(i=e.callsByType&&e.callsByType.inbound)&&void 0!==i?i:0}),(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:0}),(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:0}),(0,f.jsx)("td",{style:{padding:"10px",borderBottom:"1px solid #e5e7eb"},children:e.apiDate?new Date(e.apiDate).toLocaleString():"-"})]},(null===(l=e.numberId)||void 0===l?void 0:l.toString())||e.userId||s)})})]})}),A>1&&(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:16,gap:8},children:[(0,f.jsx)("button",{onClick:()=>S(e=>Math.max(1,e-1)),disabled:1===w,style:{padding:"6px 14px",borderRadius:4,border:"1px solid #e5e7eb",background:1===w?"#f3f4f6":"#fff",cursor:1===w?"not-allowed":"pointer"},children:"Prev"}),Array.from({length:A},(e,s)=>(0,f.jsx)("button",{onClick:()=>S(s+1),style:{padding:"6px 12px",borderRadius:4,border:"1px solid #e5e7eb",background:w===s+1?"#2563eb":"#fff",color:w===s+1?"#fff":"#222",fontWeight:w===s+1?600:400,cursor:"pointer"},children:s+1},s+1)),(0,f.jsx)("button",{onClick:()=>S(e=>Math.min(A,e+1)),disabled:w===A,style:{padding:"6px 14px",borderRadius:4,border:"1px solid #e5e7eb",background:w===A?"#f3f4f6":"#fff",cursor:w===A?"not-allowed":"pointer"},children:"Next"})]})]})]})}},50997:function(e,s,l){l.d(s,{X:function(){return a}});const a=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='427.314 107.313 404.686 84.687 256 233.373 107.314 84.687 84.686 107.313 233.373 256 84.686 404.687 107.314 427.313 256 278.627 404.686 427.313 427.314 404.687 278.627 256 427.314 107.313' class='ci-primary'/>"]}}]);