"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[615],{20615:function(e,l,a){a.r(l);var i=a(9950),t=a(26910),n=a(28429),d=a(42074),s=(a(26019),a(11031)),o=a(27081),r=a(35887),c=a(10226),u=a(44414);l.default=function(){var e,l,a,m,v,h,x,p,j,g,N,y;const{status:b,id:_}=(0,n.g)(),{cartItems:w,subTotal:f,shippingCharge:A,tax:C,shipingInfo:O,total:S}=(0,o.d4)(e=>e.cart),P=((0,o.d4)(e=>e),(0,i.useRef)()),I=(0,i.useRef)(),z=(0,o.wA)(),k=(0,n.Zp)(),L=((0,i.useRef)(),(0,s.g)()),[D,F]=(0,i.useState)([]),[R,T]=(0,i.useState)([]),[W,B]=(0,i.useState)([]),[M,q]=(0,i.useState)(),[E,H]=(0,i.useState)(!0),[U,V]=(0,i.useState)(""),[Z,G]=(0,i.useState)({product_Name:"",address:"",quantity:"",contact_Number:"",total_Price:""});return(0,i.useEffect)(()=>{(async()=>{const e=await t.A.get("/api/tax/view_tax",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}});e.data&&B(e.data)})()},[L]),(0,i.useEffect)(()=>{H(!0),t.A.get("/api/product/getAll/admin",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{H(!1),F(e.data.product)}).catch(e=>{H(!1)}),H(!0),t.A.get("/api/franchisee",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{H(!1),console.log(e.data.data),T(e.data.data)}).catch(e=>{H(!1)})},[]),(0,u.jsxs)(u.Fragment,{children:[" ",(0,u.jsx)("div",{className:"main-content",children:(0,u.jsx)("div",{className:"page-content",children:(0,u.jsxs)("div",{className:"container-fluid",children:[(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-12",children:(0,u.jsxs)("div",{className:" page-title-box d-flex align-items-center justify-content-between ",children:[(0,u.jsx)("div",{style:{fontSize:"22px"},className:"fw-bold",children:"Add Order"}),(0,u.jsxs)("div",{className:"page-title-right",children:[(0,u.jsx)(c.A,{variant:"contained",color:"primary",style:{fontWeight:"bold",marginBottom:"1rem",textTransform:"capitalize",marginRight:"5px"},onClick:()=>{null!==O?w.length<1?swal({title:"Warning",text:"Please select atleast one product",icon:"error",button:"Close",dangerMode:!0}):""!==C&&""!==A&&""!==S?(H(!0),H(!0),t.A.post("/api/order/create",{orderItems:w,shippingInfo:O,shipping_charge:A,tax_amount:C,total_amount:S},{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{swal({title:"Created",text:e.data.message?e.data.message:"Order created!",icon:"success",button:"ok"}),H(!1),k("/orders/new")}).catch(e=>{H(!1),swal({title:"Warning",text:e.response.data.message?e.response.data.message:"Something went wrong!",icon:"error",button:"Retry",dangerMode:!0})})):swal({title:"Warning",text:"Fill all mandatory fields",icon:"error",button:"Close",dangerMode:!0}):swal({title:"Warning",text:"Please select Franchisee ",icon:"error",button:"Close",dangerMode:!0})},disabled:E,children:E?"Loading":"Order Now"}),(0,u.jsx)(d.N_,{to:"/orders/new",children:(0,u.jsx)(c.A,{variant:"contained",color:"secondary",style:{fontWeight:"bold",marginBottom:"1rem",textTransform:"capitalize"},children:"Back"})})]})]})})}),(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-lg-6 mt-3",children:(0,u.jsx)("div",{className:"card",children:(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsxs)("div",{className:"mt-1",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Franchisee :"}),(0,u.jsxs)("div",{className:"d-flex",children:[(0,u.jsxs)("select",{className:"form-control me-2",onChange:e=>{"text"===e.target.type?G(l=>({...l,[e.target.id]:e.target.value})):V(e.target.value)},value:U,ref:I,disabled:null!==O,children:[(0,u.jsx)("option",{value:"",disabled:!0}),R&&R.map((e,l)=>(0,u.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},l))]}),(0,u.jsx)("button",{className:"btn-sm btn-primary",onClick:e=>(async()=>{console.log(I.current.value),t.A.get("/api/franchisee/arrayspopulate/".concat(I.current.value),{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{var l,a,i,t,n,d,s,o,c,u,m,v,h,x,p,j,g,N,y,b,_,w,f,A,C,O;H(!1),console.log(e.data.data);let S={Franchisee:null===e||void 0===e||null===(l=e.data)||void 0===l||null===(a=l.data)||void 0===a?void 0:a._id,name:null===e||void 0===e||null===(i=e.data)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.name,contact_Number:null===e||void 0===e||null===(n=e.data)||void 0===n||null===(d=n.data)||void 0===d?void 0:d.contact_Number,contact_Person_Name:null===e||void 0===e||null===(s=e.data)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.contact_Person_Name,address:(null===e||void 0===e||null===(c=e.data)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.address_line_1)+" "+(null===e||void 0===e||null===(m=e.data)||void 0===m||null===(v=m.data)||void 0===v?void 0:v.address_line_2),city:null===e||void 0===e||null===(h=e.data)||void 0===h||null===(x=h.data)||void 0===x||null===(p=x.city)||void 0===p?void 0:p.city_name,price_Lable:null===e||void 0===e||null===(j=e.data)||void 0===j||null===(g=j.data)||void 0===g?void 0:g.price_Lable,state:null===e||void 0===e||null===(N=e.data)||void 0===N||null===(y=N.data)||void 0===y||null===(b=y.city)||void 0===b||null===(_=b.state)||void 0===_?void 0:_.state_name,banner:null===e||void 0===e||null===(w=e.data)||void 0===w||null===(f=w.data)||void 0===f||null===(A=f.banner)||void 0===A?void 0:A.url,Franchisee_Url:null===e||void 0===e||null===(C=e.data)||void 0===C||null===(O=C.data)||void 0===O?void 0:O.url};z({type:"addShippingInfo",payload:S}),r.Ay.success("Franchisee Added")}).catch(e=>{H(!1)})})(),children:"Add"})]})]}),null!==O&&(0,u.jsxs)("div",{className:"my-2",children:[(0,u.jsxs)("div",{className:"row",style:{fontSize:"14px"},children:[(0,u.jsx)("div",{className:"col-sm-4",children:(0,u.jsx)("img",{src:null===O||void 0===O?void 0:O.banner,alt:null===O||void 0===O?void 0:O.name,width:"100%"})}),(0,u.jsxs)("div",{className:"col-sm-8",children:[(0,u.jsx)("h6",{className:"m-0 ms-2",children:null===O||void 0===O?void 0:O.name}),(0,u.jsxs)("parent",{className:"m-0 ms-2 mt-3",children:["Address. : ",null===O||void 0===O?void 0:O.address]}),(0,u.jsxs)("p",{className:"m-0 ms-2 mt-1",children:["Contact No. : ",null===O||void 0===O?void 0:O.contact_Number]}),(0,u.jsxs)("p",{className:"m-0 ms-2 mt-1",children:["Contact Person Name :"," ",null===O||void 0===O?void 0:O.contact_Person_Name]}),(0,u.jsxs)("p",{className:"m-0 ms-2 mt-1",children:["Price Lable : ",null===O||void 0===O?void 0:O.price_Lable]}),(0,u.jsx)("button",{className:"btn btn-danger btn-sm ms-2 mt-2",onClick:()=>(e=>{z({type:"deleteFromshippingInfo",payload:{Franchisee:e}}),r.Ay.success("Franchisee Removed")})(null===O||void 0===O?void 0:O.id),children:"Delete"})]})]}),(0,u.jsx)("hr",{})]}),(0,u.jsx)("div",{className:"mt-3",children:(0,u.jsxs)("label",{children:[(0,u.jsx)("span",{className:"fw-bold",children:"Razorpay Order ID : "}),null===D||void 0===D?void 0:D.razorpay_order_id]})})," ",(0,u.jsx)("div",{className:"mt-1",children:(0,u.jsxs)("label",{children:[(0,u.jsx)("span",{className:"fw-bold",children:"Razorpay Payment ID : "}),null===D||void 0===D?void 0:D.razorpay_payment_id]})})]})})}),(0,u.jsxs)("div",{className:"col-lg-6 mt-3",children:[null!==O&&(0,u.jsx)("div",{className:"card",children:(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsxs)("div",{className:"mt-1",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Select Product:"}),(0,u.jsxs)("div",{className:"d-flex",children:[(0,u.jsxs)("select",{className:"form-control me-2",ref:P,children:[(0,u.jsx)("option",{value:"",children:"-----"}),D&&D.map((e,l)=>(0,u.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},l))]}),(0,u.jsx)("button",{className:"btn-sm btn-primary",onClick:e=>(async()=>{t.A.get("/api/product/getOne/".concat(P.current.value),{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{var l,a,i,t,n,d,s,o,c,u,m;H(!1);const v=Object.keys(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.product),h=Object.values(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.product),x=v.indexOf(null===O||void 0===O?void 0:O.price_Lable),p=v.indexOf("".concat(null===O||void 0===O?void 0:O.price_Lable,"_With_Tax"));let j={name:null===e||void 0===e||null===(i=e.data)||void 0===i||null===(t=i.product)||void 0===t?void 0:t.name,price:h[x],product:null===e||void 0===e||null===(n=e.data)||void 0===n||null===(d=n.product)||void 0===d?void 0:d._id,quantity:1,image:null===e||void 0===e||null===(s=e.data)||void 0===s||null===(o=s.product)||void 0===o||null===(c=o.image)||void 0===c?void 0:c.url,taxId:null===e||void 0===e||null===(u=e.data)||void 0===u||null===(m=u.product)||void 0===m?void 0:m.taxId,price_With_Tax:h[p]};z({type:"addToCart",payload:j}),z({type:"calculatePrice"}),r.Ay.success("Product Added")}).catch(e=>{H(!1)})})(),children:"Add"})]})]}),(0,u.jsxs)("div",{className:"mt-2",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Product :"}),w&&w.map((e,l)=>(0,u.jsxs)("div",{className:"my-2",children:[(0,u.jsxs)("div",{className:"row",style:{fontSize:"14px"},children:[(0,u.jsx)("div",{className:"col-sm-4",children:(0,u.jsx)("img",{src:null===e||void 0===e?void 0:e.image,alt:null===e||void 0===e?void 0:e.name,style:{width:"100%",objectFit:"contain",maxHeight:"150px"}})}),(0,u.jsxs)("div",{className:"col-sm-8",children:[(0,u.jsx)("h6",{className:"m-0 ms-2",children:null===e||void 0===e?void 0:e.name}),(0,u.jsxs)("div",{className:"row",children:[(0,u.jsxs)("div",{className:"col-sm-6",children:[(0,u.jsxs)("div",{className:"d-flex justify-content-center mt-3 me-3 ",style:{width:"6rem"},children:[(0,u.jsx)("button",{className:"btn btn-sm btn-primary ",onClick:()=>(e=>{z({type:"decrement",payload:{product:e}}),z({type:"calculatePrice"})})(null===e||void 0===e?void 0:e.product),children:"-"}),(0,u.jsx)("span",{className:"px-2 mt-1",style:{},children:null===e||void 0===e?void 0:e.quantity}),(0,u.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{z({type:"addToCart",payload:{product:e}}),z({type:"calculatePrice"})})(null===e||void 0===e?void 0:e.product),children:"+"})]}),(0,u.jsxs)("p",{className:"m-0 mt-3",children:[(0,u.jsx)("stong",{children:"Price With Tax:"})," \u20b9",null===e||void 0===e?void 0:e.price_With_Tax]}),(0,u.jsx)("button",{className:"btn btn-danger btn-sm ms-2 mt-3",onClick:()=>(e=>{z({type:"deleteFromCart",payload:{product:e}}),z({type:"calculatePrice"}),r.Ay.success("Item Removed")})(null===e||void 0===e?void 0:e.product),children:"Delete"})]}),(0,u.jsx)("div",{className:"col-sm-6",children:(0,u.jsxs)("p",{className:"m-0 mt-3",children:[(0,u.jsx)("stong",{children:" Price:"})," \u20b9",null===e||void 0===e?void 0:e.price]})})]})]})]}),(0,u.jsx)("hr",{})]})),f&&(0,u.jsxs)("h5",{className:"m-0 contents-center mt-3",children:[(0,u.jsx)("span",{children:" Total Order Value:"})," \u20b9",f]})]})]})}),(0,u.jsx)("div",{className:"card my-1",children:(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Status Timeline :"}),(0,u.jsx)("table",{className:"table table-info table-sm m-0",style:{borderRadius:"8px",borderCollapse:"collapse",overflow:"hidden"},children:(0,u.jsxs)("tbody",{children:[(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Order Placed On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(e=D.status_timeline)&&void 0!==e&&e.new?new Date(null===D||void 0===D||null===(l=D.status_timeline)||void 0===l?void 0:l.new).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):new Date(null===D||void 0===D?void 0:D.placed_on).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0})})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Processing Started"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(a=D.status_timeline)&&void 0!==a&&a.processing?new Date(null===D||void 0===D||null===(m=D.status_timeline)||void 0===m?void 0:m.processing).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Dispatched On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(v=D.status_timeline)&&void 0!==v&&v.dispatched?new Date(null===D||void 0===D||null===(h=D.status_timeline)||void 0===h?void 0:h.dispatched).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Delivered On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(x=D.status_timeline)&&void 0!==x&&x.delivered?new Date(null===D||void 0===D||null===(p=D.status_timeline)||void 0===p?void 0:p.delivered).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Cancelled On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(j=D.status_timeline)&&void 0!==j&&j.cancelled?new Date(null===D||void 0===D||null===(g=D.status_timeline)||void 0===g?void 0:g.cancelled).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Returned On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(N=D.status_timeline)&&void 0!==N&&N.returned?new Date(null===D||void 0===D||null===(y=D.status_timeline)||void 0===y?void 0:y.returned).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]})]})})]})})]})]})]})})}),(0,u.jsx)("div",{style:{display:"none"}})]})}}}]);