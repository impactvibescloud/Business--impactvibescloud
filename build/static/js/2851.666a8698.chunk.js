"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2851],{82851:function(e,t,a){a.r(t);var i=a(9950),n=a(10226),l=a(28429),s=a(42074),o=a(6536),r=a.n(o),c=a(26910),d=a(11031),m=(a(49911),a(72348)),h=a.n(m),p=(a(4434),a(44414));t.default=()=>{const e=(0,d.g)(),t=(0,l.Zp)(),[a,o]=(0,i.useState)([]),[m,u]=(0,i.useState)({doctorId:"",doctorName:"",date:"",time:"",patientName:"",patientPhone:""}),[x,N]=(0,i.useState)(!1);(0,i.useEffect)(()=>{c.A.get("/api/specialist/getall").then(e=>{o(e.data.specialist)}).catch(e=>{r()("Error","Could not get data","error")})},[]);const g=[...a.map(e=>({label:e.specialistName,value:e._id}))],f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],[b,j]=(0,i.useState)([]),[v,y]=(0,i.useState)([]),[S,w]=(0,i.useState)(),_=e=>{const t=e.target.value,i=a.find(e=>e._id===t),n=i.daysAvailable.filter(e=>!0===e.available),l=n.map(e=>(e=>f.indexOf(e))(e.label));y(l),w(i.perPatientTime),j(n),u(e=>({...e,doctorId:t,doctorName:i.specialistName,date:"",time:""}))},[P,T]=(0,i.useState)([]),C=async e=>{var t;const a=(e=>b.filter(t=>t.label===e))((t=e.getDay(),f[t])),i=await((e,t)=>{const a=[];return e.forEach(e=>{const i=new Date("January 1, 2022 ".concat(e.startTime)),n=new Date("January 1, 2022 ".concat(e.endTime));let l=i;for(;l<n;){const e=new Date(l.getTime()+6e4*t),i="".concat(l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ").concat(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),n=l.toISOString();a.push({label:i,value:n}),l=e}}),a})(a[0].timeSlots,S);await T(i),u(t=>({...t,date:e,time:""}))},D=e=>{u(t=>({...t,[e.target.id]:e.target.value}))};return(0,p.jsxs)("div",{className:"container",children:[(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12",children:(0,p.jsxs)("div",{className:" page-title-box d-flex align-items-center justify-content-between ",children:[(0,p.jsx)("div",{style:{fontSize:"22px"},className:"fw-bold",children:"New Appointment"}),(0,p.jsx)("div",{style:{display:"flex",gap:"1rem"},children:(0,p.jsx)("h4",{className:"mb-0"})}),(0,p.jsxs)("div",{className:"page-title-right",children:[(0,p.jsx)(n.A,{variant:"contained",color:"primary",style:{fontWeight:"bold",marginBottom:"1rem",textTransform:"capitalize",marginRight:"5px"},onClick:()=>(()=>{if(""===m.doctorName.trim()||""===m.date||""===m.time||""===m.patientName.trim()||""===m.patientPhone.trim())return void r()({title:"Warning",text:"Fill all mandatory fields",icon:"error",button:"Close",dangerMode:!0});N(!0);const a=new FormData;a.set("doctorId",m.doctorId),a.set("doctorName",m.doctorName),a.set("date",m.date),a.set("time",m.time),a.set("patientName",m.patientName),a.set("patientPhone",m.patientPhone),c.A.post("/api/appointment/new/",a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/formdata","Access-Control-Allow-Origin":"*"}}).then(e=>{r()({title:"Added",text:"appointment added successfully!",icon:"success",button:"ok"}),N(!1),t("/appointments",{replace:!0})}).catch(e=>{var t,a;N(!1);const i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Something went wrong!";r()({title:"Warning",text:i,icon:"error",button:"Retry",dangerMode:!0})})})(),disabled:x,children:x?"Loading":"Add"}),(0,p.jsx)(s.N_,{to:"/appointments",children:(0,p.jsx)(n.A,{variant:"contained",color:"secondary",style:{fontWeight:"bold",marginBottom:"1rem",textTransform:"capitalize"},children:"Back"})})]})]})})}),(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-lg-12 col-md-12  col-sm-12 my-1",children:(0,p.jsx)("div",{className:"card h-100",children:(0,p.jsxs)("div",{className:"card-body px-5",children:[(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsx)("label",{htmlFor:"doctorName",className:"form-label",children:"Doctor Name *"}),(0,p.jsxs)("select",{type:"select",className:"form-control",id:"doctorName",name:"doctorName",onChange:e=>_(e),options:g,children:[(0,p.jsx)("option",{hidden:!0,children:"Select Doctor"}),g.map(e=>(0,p.jsx)("option",{value:e.value,children:e.label},e.label))]})]}),m.doctorId&&(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsx)("label",{htmlFor:"date",className:"form-label",children:"Date *"}),(0,p.jsx)(h(),{type:"date",className:"form-control",id:"date",name:"date",selected:m.date,onChange:e=>C(e),dateFormat:"dd/MM/yyyy",minDate:new Date,placeholderText:"Select a date",filterDate:e=>v.includes(e.getDay())})]}),m.date&&(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsx)("label",{htmlFor:"time",className:"form-label",children:"Time *"}),(0,p.jsxs)("select",{type:"select",className:"form-control",id:"time",name:"time",value:m.time,options:P,onChange:e=>D(e),children:[(0,p.jsx)("option",{hidden:!0,children:"Select Time"}),P.map(e=>(0,p.jsx)("option",{value:e.value,children:e.label},e.label))]})]}),(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsx)("label",{htmlFor:"patientName",className:"form-label",children:"Patient Name *"}),(0,p.jsx)("input",{type:"text",className:"form-control",id:"patientName",value:m.patientName,placeholder:"Enter Patient Name",maxLength:"100",onChange:e=>D(e)}),m.patientName?(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("small",{className:"charLeft mt-4 fst-italic",children:[100-m.patientName.length," characters left"]})}):(0,p.jsx)(p.Fragment,{})]}),(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsx)("label",{htmlFor:"patientPhone",className:"form-label",children:"Patient Phone *"}),(0,p.jsx)("input",{type:"tel",className:"form-control",id:"patientPhone",value:m.patientPhone,placeholder:"Enter Patient Phone",maxLength:"10",onChange:e=>D(e)})]})]})})})})]})}}}]);