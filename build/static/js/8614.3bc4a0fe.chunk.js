"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[8614],{88614:function(e,t,a){a.r(t);var s=a(26910),l=a(9950),r=a(28429),n=a(42074),i=a(6536),d=a.n(i),o=a(11031),c=a(93722),u=a(86008),h=a(73311),m=a(68456),x=a(82053),p=a(78428),v=a(29925),j=a(44414);t.default=()=>{const e=(0,o.g)(),{_id:t}=(0,r.g)(),a=(0,r.Zp)(),[i,b]=(0,l.useState)(null),[g,y]=(0,l.useState)({totalOrders:0,totalValue:0,lastPurchaseOrderDate:null}),[N,f]=(0,l.useState)([]),[A,w]=(0,l.useState)(null),[S,C]=(0,l.useState)(null),[E,q]=(0,l.useState)(null),[_,k]=(0,l.useState)(!1),[B,z]=(0,l.useState)(!1),[D,I]=(0,l.useState)([]),[P,T]=(0,l.useState)([]),[W,O]=(0,l.useState)(null),[L,F]=(0,l.useState)(null),[H,Y]=(0,l.useState)([]),[R,Q]=(0,l.useState)({Name:"",tradeName:"",gstNumber:"",panNumber:"",phoneNumber:"",street:"",city:"",state:"",postalCode:"",country:"India",isDefault:!1}),[U,V]=(0,l.useState)(!1),[G,M]=(0,l.useState)({_id:"",price:""});(0,l.useEffect)(()=>{(()=>{const e=c.Ay.getStatesOfCountry("IN").map(e=>({label:e.name,value:e.isoCode}));I(e)})()},[]),(0,l.useEffect)(()=>{(()=>{if(W){const e=u.A.getCitiesOfState("IN",W.value).map(e=>({label:e.name,value:e.name}));T(e)}else T([])})(),(async()=>{try{const a=await s.A.get("/api/outlet/get/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});Y(a.data.data)}catch(a){console.error("Error fetching products:",a),d()("Error","Failed to fetch products.","error")}})()},[W,t,e]);const Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;z(!!e);if(Q(e||{Name:"",tradeName:E,gstNumber:A,panNumber:S,phoneNumber:"",street:"",city:"",state:"",postalCode:"",country:"India",isDefault:!1}),e){const t=D.find(t=>t.label===e.state)||null;if(O(t),t){const a=u.A.getCitiesOfState("IN",t.value).map(e=>({label:e.name,value:e.name}));T(a);const s=a.find(t=>t.label===e.city)||null;F(s)}}else O(null),F(null),T([]);k(!0)},J=()=>{k(!1),O(null),F(null),Q({Name:"",tradeName:"",gstNumber:"",panNumber:"",phoneNumber:"",street:"",city:"",state:"",postalCode:"",country:"India",isDefault:!1})},K=()=>{V(!1),M({_id:"",price:""})},X=(0,l.useCallback)(async()=>{try{var a,l,r;const n=await s.A.get("/api/shipping/address/user/address/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});f((null===(a=n.data)||void 0===a?void 0:a.UserShippingAddress)||[]);const i=(null===(l=n.data)||void 0===l?void 0:l.UserShippingAddress.find(e=>e.isDefault))||(null===(r=n.data)||void 0===r?void 0:r.UserShippingAddress[0])||{};w(i.gstNumber||""),C(i.panNumber||""),q(i.tradeName||"")}catch(n){d()("Warning",n.message,"error")}},[t,e]),$=(0,l.useCallback)(async()=>{try{const a=await s.A.get("/api/single-pd-ordercount/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});y(a.data)}catch(a){d()("Warning",a.message,"error")}},[t,e]),ee=(0,l.useCallback)(async()=>{try{const a=await s.A.get("/api/v1/admin/user/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});b(a.data.user)}catch(a){d()("Warning",a.message,"error")}},[t,e]);(0,l.useEffect)(()=>{$(),X(),ee()},[t,$,X,ee]);const[te,ae]=(0,l.useState)([]),[se,le]=(0,l.useState)(!1),[re,ne]=(0,l.useState)({_id:"",quantity:""}),ie=async()=>{try{const a=await s.A.get("/api/equipment/outlet/get/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});console.log("Equipments:",a.data.data.equipment),ae(a.data.data.equipment)}catch(a){console.error("Error fetching equipments:",a),d()("Error","Failed to fetch equipments.","error")}};(0,l.useEffect)(()=>{ie()},[t,e]);const de=()=>{le(!1),ne({_id:"",quantity:""})};return(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-12",children:(0,j.jsxs)("div",{className:"page-title-box d-flex align-items-center justify-content-between",children:[(0,j.jsx)("div",{style:{fontSize:"22px"},className:"fw-bold",children:"Outlet All Details"}),(0,j.jsx)("div",{className:"page-title-right",children:(0,j.jsx)(n.N_,{to:"/franchisee",children:(0,j.jsx)(h.A,{className:"btn btn-danger btn-sm",children:"Back"})})})]})})}),(0,j.jsxs)("div",{className:"card",style:{padding:"1rem"},children:[(0,j.jsx)("h5",{style:{fontWeight:"bold"},children:"\u2022 Outlet Profile"}),(0,j.jsxs)("div",{style:{marginLeft:"1rem",marginTop:"1rem"},children:[(0,j.jsxs)(x.A,{style:{fontWeight:"bold",fontSize:"1.2rem",marginBottom:"1rem"},children:["Outlet ID:",(0,j.jsx)(x.A,{component:"span",style:{fontWeight:"normal",marginLeft:"0.5rem"},children:null===i||void 0===i?void 0:i.uniqueId})]}),(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,j.jsx)("div",{style:{flex:1,paddingRight:"1rem"},children:[{label:"Name",value:null===i||void 0===i?void 0:i.name},{label:"Email",value:null===i||void 0===i?void 0:i.email},{label:"Mobile Number",value:null===i||void 0===i?void 0:i.phone}].map((e,t)=>(0,j.jsxs)(x.A,{style:{fontWeight:"bold",fontSize:"1.2rem"},children:[e.label,":",(0,j.jsx)(x.A,{component:"span",style:{fontWeight:"normal",marginLeft:"0.5rem"},children:e.value})]},t))}),(0,j.jsx)("div",{style:{flex:1,paddingLeft:"1rem"},children:[{label:"Date Registered",value:new Date(null===i||void 0===i?void 0:i.createdAt).toLocaleString("en-IN",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0})},{label:"Last Purchase",value:null!==g&&void 0!==g&&g.lastPurchaseOrderDate?new Date(null===g||void 0===g?void 0:g.lastPurchaseOrderDate).toLocaleString("en-IN",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"No Purchase"},{label:"Total Orders",value:(null===g||void 0===g?void 0:g.totalOrders)||0},{label:"Total Spent",value:"\u20b9 ".concat((null===g||void 0===g?void 0:g.totalValue)||0)}].map((e,t)=>(0,j.jsxs)(x.A,{style:{fontWeight:"bold",fontSize:"1.2rem"},children:[e.label,":",(0,j.jsx)(x.A,{component:"span",style:{fontWeight:"normal",marginLeft:"0.5rem"},children:e.value})]},t))})]})]}),(0,j.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,j.jsx)("h5",{style:{fontWeight:"bold",marginBottom:"1rem"},children:"\u2022 Addresses"}),(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,j.jsxs)("h5",{style:{fontWeight:"bold"},children:["\u2022 Total Addresses: ",(null===N||void 0===N?void 0:N.length)||0]}),(0,j.jsx)(h.A,{className:"btn btn-primary",onClick:()=>Z(),children:"Add Address"})]}),(null===N||void 0===N?void 0:N.length)>0&&(0,j.jsx)("div",{className:"table-responsive table-shoot mt-3",children:(0,j.jsxs)("table",{className:"table table-centered table-nowrap",style:{border:"1px solid"},children:[(0,j.jsx)("thead",{className:"thead-info",style:{background:"rgb(140, 213, 213)"},children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{style:{width:"5%"},children:"SL No."}),(0,j.jsx)("th",{style:{width:"37%"},children:"Address"}),(0,j.jsx)("th",{style:{width:"7%"},children:"Default"}),(0,j.jsx)("th",{style:{width:"11%"},children:"Action"})]})}),(0,j.jsx)("tbody",{children:null===N||void 0===N?void 0:N.map((a,l)=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:l+1})}),(0,j.jsx)("td",{className:"text-start",children:(0,j.jsxs)("strong",{children:[null===a||void 0===a?void 0:a.Name,"-",null===a||void 0===a?void 0:a.street,", ",null===a||void 0===a?void 0:a.city,", ",null===a||void 0===a?void 0:a.state,", ",null===a||void 0===a?void 0:a.country,", ",null===a||void 0===a?void 0:a.postalCode]})}),(0,j.jsx)("td",{className:"text-center",children:(0,j.jsx)("strong",{children:a.isDefault?"Yes":"No"})}),(0,j.jsxs)("td",{className:"text-start",children:[(0,j.jsx)(h.A,{className:"btn btn-warning btn-sm me-2",onClick:()=>Z(a),children:"Edit"}),(0,j.jsx)(h.A,{className:"btn btn-danger btn-sm",onClick:()=>(async a=>{try{const l=await s.A.delete("/api/shipping/address/delete/".concat(a),{headers:{Authorization:"Bearer ".concat(e)},data:{userId:t}});d()("Success",l.data.message,"success"),X()}catch(n){var l,r;d()("Warning",(null===(l=n.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.message)||n.message,"error")}})(a._id),children:"Delete"})]})]},a._id||l))})]})}),(0,j.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,j.jsx)("h5",{style:{fontWeight:"bold",marginBottom:"1rem"},children:"\u2022 Products"}),(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,j.jsxs)("h5",{style:{fontWeight:"bold"},children:["\u2022 Total Products: ",(null===H||void 0===H?void 0:H.length)||0]}),(0,j.jsx)(h.A,{className:"btn btn-primary",onClick:()=>a("/franchisee/products/".concat(t)),children:"Add Products"})]}),(null===H||void 0===H?void 0:H.length)>0?(0,j.jsx)("div",{className:"table-responsive table-shoot mt-3",children:(0,j.jsxs)("table",{className:"table table-centered table-nowrap",style:{border:"1px solid"},children:[(0,j.jsx)("thead",{className:"thead-info",style:{background:"rgb(140, 213, 213)"},children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{style:{width:"5%"},children:"SL No."}),(0,j.jsx)("th",{style:{width:"30%"},children:"Name"}),(0,j.jsx)("th",{style:{width:"25%"},children:"Category"}),(0,j.jsx)("th",{style:{width:"15%"},children:"Price"}),(0,j.jsx)("th",{style:{width:"15%"},children:"Action"})]})}),(0,j.jsx)("tbody",{children:H.map((a,l)=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:l+1})}),(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:(null===a||void 0===a?void 0:a.menuItem.item)||"N/A"})}),(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:(null===a||void 0===a?void 0:a.menuItem.category.categoryName)||"N/A"})}),(0,j.jsx)("td",{className:"text-start",children:(0,j.jsxs)("strong",{children:["\u20b9 ",(null===a||void 0===a?void 0:a.price)||0]})}),(0,j.jsxs)("td",{className:"text-start",children:[(0,j.jsx)(h.A,{className:"btn btn-warning btn-sm me-2",onClick:()=>(e=>{M({_id:e._id,price:e.price||""}),V(!0)})(a),children:"Edit"}),(0,j.jsx)(h.A,{className:"btn btn-danger btn-sm",onClick:()=>(async a=>{try{await s.A.delete("/api/outlet/delete/".concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),d()("Success!","Product deleted successfully!","success");const l=await s.A.get("/api/outlet/get/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});Y(l.data.data)}catch(n){var l,r;console.error("Error deleting product:",n),d()("Error!",(null===(l=n.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.error)||"Failed to delete product.","error")}})(a._id),children:"Remove"})]})]},a._id||l))})]})}):(0,j.jsx)("div",{className:"alert alert-info mt-3",children:"No products available"})]}),(0,j.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,j.jsx)("h5",{style:{fontWeight:"bold",marginBottom:"1rem"},children:"\u2022 Equipments"}),(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,j.jsxs)("h5",{style:{fontWeight:"bold"},children:["\u2022 Total Equipments: ",(null===te||void 0===te?void 0:te.length)||0]}),(0,j.jsx)(h.A,{className:"btn btn-primary",onClick:()=>a("/franchisee/equipments/".concat(t)),children:"Add Equipments"})]}),(null===te||void 0===te?void 0:te.length)>0?(0,j.jsx)("div",{className:"table-responsive table-shoot mt-3",children:(0,j.jsxs)("table",{className:"table table-centered table-nowrap",style:{border:"1px solid"},children:[(0,j.jsx)("thead",{className:"thead-info",style:{background:"rgb(140, 213, 213)"},children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{style:{width:"5%"},children:"SL No."}),(0,j.jsx)("th",{style:{width:"20%"},children:"Name"}),(0,j.jsx)("th",{style:{width:"15%"},children:"Quantity"}),(0,j.jsx)("th",{style:{width:"25%"},children:"Action"})]})}),(0,j.jsx)("tbody",{children:te.map((a,l)=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:l+1})}),(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:a.equipmentId.name||"N/A"})}),(0,j.jsx)("td",{className:"text-start",children:(0,j.jsx)("strong",{children:(null===a||void 0===a?void 0:a.quantity)||0})}),(0,j.jsxs)("td",{className:"text-start",children:[(0,j.jsx)(h.A,{className:"btn btn-warning btn-sm me-2",onClick:()=>(e=>{ne({_id:e._id,quantity:e.quantity||""}),le(!0)})(a),children:"Edit"}),(0,j.jsx)(h.A,{className:"btn btn-danger btn-sm",onClick:()=>(async a=>{try{await s.A.delete("/api/outlet/equipment/delete/".concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),d()("Success!","Equipment deleted successfully!","success");const l=await s.A.get("/api/outlet/equipments/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});ae(l.data.data)}catch(n){var l,r;console.error("Error deleting equipment:",n),d()("Error!",(null===(l=n.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.error)||"Failed to delete equipment.","error")}})(a._id),children:"Remove"})]})]},a._id||l))})]})}):(0,j.jsx)("div",{className:"alert alert-info mt-3",children:"No equipments available"})]}),(0,j.jsxs)(m.A,{show:_,onHide:J,dialogClassName:"modal-lg",children:[(0,j.jsx)(m.A.Header,{closeButton:!0,children:(0,j.jsx)(m.A.Title,{children:B?"Edit Shipping Address":"Add Shipping Address"})}),(0,j.jsx)(m.A.Body,{children:(0,j.jsxs)("div",{className:"container",children:[(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"Name"}),(0,j.jsx)("input",{type:"text",value:(null===R||void 0===R?void 0:R.Name)||"",onChange:e=>Q({...R,Name:e.target.value}),className:"form-control mb-3",placeholder:"Enter name"})]})}),(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"GST Number"}),(0,j.jsx)("input",{type:"text",value:(null===R||void 0===R?void 0:R.gstNumber)||"",onChange:e=>Q({...R,gstNumber:e.target.value}),className:"form-control mb-3",placeholder:"Enter GST number"})]})}),(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"Phone Number"}),(0,j.jsx)("input",{type:"text",value:(null===R||void 0===R?void 0:R.phoneNumber)||"",onChange:e=>Q({...R,phoneNumber:e.target.value}),className:"form-control mb-3",placeholder:"Enter phone number"})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"Street"}),(0,j.jsx)("input",{type:"text",value:(null===R||void 0===R?void 0:R.street)||"",onChange:e=>Q({...R,street:e.target.value}),className:"form-control mb-3",placeholder:"Enter street"})]})]}),(0,j.jsxs)("div",{className:"row mb-4 mt-3",children:[(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsx)(p.A,{options:D,value:W,onChange:(e,t)=>{O(t),Q(e=>({...e,state:t?t.label:"",city:""})),F(null),T([])},renderInput:e=>(0,j.jsx)(v.A,{...e,label:"Select State"})})}),(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsx)(p.A,{options:P,value:L,onChange:(e,t)=>{F(t),Q(e=>({...e,city:t?t.label:""}))},isOptionEqualToValue:(e,t)=>e.value===t.value,renderInput:e=>(0,j.jsx)(v.A,{...e,label:"Select City"})})})]}),(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"Postal Code"}),(0,j.jsx)("input",{type:"text",value:(null===R||void 0===R?void 0:R.postalCode)||"",onChange:e=>Q({...R,postalCode:e.target.value}),className:"form-control mb-3",placeholder:"Enter postal code"})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"Country"}),(0,j.jsx)("input",{type:"text",disabled:!0,value:(null===R||void 0===R?void 0:R.country)||"",className:"form-control mb-3"})]})]}),(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{children:"Is Default Address"}),(0,j.jsxs)("select",{className:"form-control mb-3",value:R.isDefault?"Yes":"No",onChange:e=>Q({...R,isDefault:"Yes"===e.target.value}),children:[(0,j.jsx)("option",{value:"Yes",children:"Yes"}),(0,j.jsx)("option",{value:"No",children:"No"})]})]})})]})}),(0,j.jsx)(m.A.Footer,{children:(0,j.jsx)(h.A,{variant:"primary",onClick:async()=>{try{const a=B?"/api/shipping/address/update/".concat(R._id):"/api/shipping/address/admin/new/".concat(t),l=B?"patch":"post";await s.A[l](a,R,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),d()("Success!","Address ".concat(B?"updated":"added"," successfully!"),"success"),J(),X()}catch(a){console.error("Error saving address:",a),d()("Error!","There was an error saving the address.","error")}},children:"Save"})})]}),(0,j.jsxs)(m.A,{show:U,onHide:K,children:[(0,j.jsx)(m.A.Header,{closeButton:!0,children:(0,j.jsx)(m.A.Title,{children:"Edit Product Price"})}),(0,j.jsx)(m.A.Body,{children:(0,j.jsx)("div",{className:"container",children:(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-12",children:[(0,j.jsx)("label",{children:"Price (\u20b9)"}),(0,j.jsx)("input",{type:"number",value:G.price,onChange:e=>M({...G,price:e.target.value}),className:"form-control mb-3",placeholder:"Enter price",min:"0"})]})})})}),(0,j.jsxs)(m.A.Footer,{children:[(0,j.jsx)(h.A,{variant:"secondary",onClick:K,children:"Cancel"}),(0,j.jsx)(h.A,{variant:"primary",onClick:async()=>{try{await s.A.put("/api/outlet/edit/".concat(G._id),{price:G.price},{headers:{Authorization:"Bearer ".concat(e)}}),d()("Success!","Product updated successfully!","success"),K();const a=await s.A.get("/api/outlet/get/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});Y(a.data.data)}catch(r){var a,l;console.error("Error updating product:",r),d()("Error!",(null===(a=r.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.error)||"Failed to update product.","error")}},children:"Save"})]})]})]})]}),(0,j.jsxs)(m.A,{show:se,onHide:de,children:[(0,j.jsx)(m.A.Header,{closeButton:!0,children:(0,j.jsx)(m.A.Title,{children:"Edit Equipment Quantity"})}),(0,j.jsx)(m.A.Body,{children:(0,j.jsx)("div",{className:"container",children:(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-12",children:[(0,j.jsx)("label",{children:"Quantity"}),(0,j.jsx)("input",{type:"number",value:re.quantity,onChange:e=>ne({...re,quantity:e.target.value}),className:"form-control mb-3",placeholder:"Enter quantity",min:"0"})]})})})}),(0,j.jsxs)(m.A.Footer,{children:[(0,j.jsx)(h.A,{variant:"secondary",onClick:de,children:"Cancel"}),(0,j.jsx)(h.A,{variant:"primary",onClick:async()=>{try{await s.A.put("/api/equipment/outlet/update/".concat(t),{quantity:re.quantity,equipmentId:re._id},{headers:{Authorization:"Bearer ".concat(e)}}),d()("Success!","Equipment updated successfully!","success"),de(),ie(),ae(response.data.data)}catch(r){var a,l;console.error("Error updating equipment:",r),d()("Error!",(null===(a=r.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.error)||"Failed to update equipment.","error")}},children:"Save"})]})]})]})}}}]);