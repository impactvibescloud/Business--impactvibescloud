"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[76],{76:function(e,l,i){i.r(l);var n=i(9950),a=i(26910),d=i(28429),t=i(42074),o=(i(26019),i(11031)),s=i(27081),r=i(35887),c=i(10226),u=i(44414);l.default=function(){var e,l,i,v,m,h,p,x,j,g,y,N;const{status:b,id:_}=(0,d.g)(),{cartItems:f,subTotal:w,shippingCharge:A,tax:I,shipingInfo:C,total:O}=(0,s.d4)(e=>e.cart),S=((0,s.d4)(e=>e),(0,n.useRef)()),P=(0,n.useRef)(),z=(0,s.wA)(),F=(0,d.Zp)(),L=((0,n.useRef)(),(0,o.g)()),[D,k]=(0,n.useState)([]),[R,T]=(0,n.useState)([]),[B,W]=(0,n.useState)([]),[E,M]=(0,n.useState)(),[q,U]=(0,n.useState)(!0),[$,H]=(0,n.useState)(null),[V,Z]=(0,n.useState)("");return(0,n.useEffect)(()=>{(async()=>{const e=await a.A.get("/api/order/getOne/".concat(_),{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}});if(e.data){var l,i,n,d,t,o,s,r,c,u,v,m,h,p,x,j,g,y,N,b,f,w,A,I,C,O,S,P,F,D,k,R,T,B,W;H(null===(l=e.data)||void 0===l||null===(i=l.order)||void 0===i?void 0:i.order_id);let a={Franchisee:null===(n=e.data)||void 0===n||null===(d=n.order)||void 0===d||null===(t=d.shippingInfo)||void 0===t||null===(o=t.Franchisee)||void 0===o?void 0:o._id,name:null===(s=e.data)||void 0===s||null===(r=s.order)||void 0===r||null===(c=r.shippingInfo)||void 0===c?void 0:c.name,contact_Number:null===(u=e.data)||void 0===u||null===(v=u.order)||void 0===v||null===(m=v.shippingInfo)||void 0===m?void 0:m.contact_Number,contact_Person_Name:null===(h=e.data)||void 0===h||null===(p=h.order)||void 0===p||null===(x=p.shippingInfo)||void 0===x?void 0:x.contact_Person_Name,address:null===(j=e.data)||void 0===j||null===(g=j.order)||void 0===g||null===(y=g.shippingInfo)||void 0===y?void 0:y.address,city:null===(N=e.data)||void 0===N||null===(b=N.order)||void 0===b||null===(f=b.shippingInfo)||void 0===f?void 0:f.city,price_Lable:null===(w=e.data)||void 0===w||null===(A=w.order)||void 0===A||null===(I=A.shippingInfo)||void 0===I||null===(C=I.Franchisee)||void 0===C?void 0:C.price_Lable,state:null===(O=e.data)||void 0===O||null===(S=O.order)||void 0===S||null===(P=S.shippingInfo)||void 0===P?void 0:P.state,banner:null===(F=e.data)||void 0===F||null===(D=F.order)||void 0===D||null===(k=D.shippingInfo)||void 0===k||null===(R=k.Franchisee)||void 0===R||null===(T=R.banner)||void 0===T?void 0:T.url};var E,M;if(z({type:"addShippingInfo",payload:a}),null!==(B=e.data)&&void 0!==B&&null!==(W=B.order)&&void 0!==W&&W.orderItems)null===(E=e.data)||void 0===E||null===(M=E.order)||void 0===M||M.orderItems.map((e,l)=>{z({type:"addToCart",payload:e}),z({type:"calculatePrice"})})}})()},[L]),(0,n.useEffect)(()=>{(async()=>{const e=await a.A.get("/api/tax/view_tax",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}});e.data&&W(e.data)})()},[L]),(0,n.useEffect)(()=>{U(!0),a.A.get("/api/product/getAll/admin",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{U(!1),k(e.data.product)}).catch(e=>{U(!1)}),U(!0),a.A.get("/api/franchisee",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{U(!1),T(e.data.data)}).catch(e=>{U(!1)})},[]),(0,u.jsxs)(u.Fragment,{children:[" ",(0,u.jsx)("div",{className:"main-content",children:(0,u.jsx)("div",{className:"page-content",children:(0,u.jsxs)("div",{className:"container-fluid",children:[(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-12",children:(0,u.jsxs)("div",{className:" page-title-box d-flex align-items-center justify-content-between ",children:[(0,u.jsxs)("div",{style:{fontSize:"22px"},className:"fw-bold",children:[(0,u.jsx)("p",{children:" Edit Order"}),$&&(0,u.jsxs)("span",{children:[(0,u.jsxs)("small",{children:["Order ID : ",$]})," "]})]}),(0,u.jsxs)("div",{className:"page-title-right",children:[(0,u.jsx)(c.A,{variant:"contained",color:"primary",style:{fontWeight:"bold",marginBottom:"1rem",textTransform:"capitalize",marginRight:"5px"},onClick:()=>{null!==C?f.length<1?swal({title:"Warning",text:"Please select atleast one product",icon:"error",button:"Close",dangerMode:!0}):""!==I&&""!==A&&""!==O?(U(!0),U(!0),a.A.put("/api/order/edit/".concat(_),{orderItems:f,shippingInfo:C,shipping_charge:A,tax_amount:I,total_amount:O},{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{swal({title:"Updated",text:e.data.message?e.data.message:"Order Updated!",icon:"success",button:"ok"}),U(!1),F("/orders/new")}).catch(e=>{U(!1),console.log(e),swal({title:"Warning",text:e.response.data.message?e.response.data.message:"Something went wrong!",icon:"error",button:"Retry",dangerMode:!0})})):swal({title:"Warning",text:"Fill all mandatory fields",icon:"error",button:"Close",dangerMode:!0}):swal({title:"Warning",text:"Please select Franchisee ",icon:"error",button:"Close",dangerMode:!0})},disabled:q,children:q?"Loading":"Edit Now"}),(0,u.jsx)(t.N_,{to:"/orders/new",children:(0,u.jsx)(c.A,{variant:"contained",color:"secondary",style:{fontWeight:"bold",marginBottom:"1rem",textTransform:"capitalize"},children:"Back"})})]})]})})}),(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-lg-6 mt-3",children:(0,u.jsx)("div",{className:"card",children:(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsxs)("div",{className:"mt-1",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Franchisee :"}),(0,u.jsxs)("div",{className:"d-flex",children:[(0,u.jsxs)("select",{className:"form-control me-2",onChange:e=>{"text"===e.target.type?setData(l=>({...l,[e.target.id]:e.target.value})):Z(e.target.value)},value:V,ref:P,disabled:null!==C,children:[(0,u.jsx)("option",{value:"",disabled:!0}),R&&R.map((e,l)=>(0,u.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},l))]}),(0,u.jsx)("button",{className:"btn-sm btn-primary",onClick:e=>(async()=>{console.log(P.current.value),a.A.get("/api/franchisee/arrayspopulate/".concat(P.current.value),{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{var l,i,n,a,d,t,o,s,c,u,v,m,h,p,x,j,g,y,N,b,_,f,w,A,I,C;U(!1),console.log(e.data.data);let O={Franchisee:null===e||void 0===e||null===(l=e.data)||void 0===l||null===(i=l.data)||void 0===i?void 0:i._id,name:null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.name,contact_Number:null===e||void 0===e||null===(d=e.data)||void 0===d||null===(t=d.data)||void 0===t?void 0:t.contact_Number,contact_Person_Name:null===e||void 0===e||null===(o=e.data)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.contact_Person_Name,address:(null===e||void 0===e||null===(c=e.data)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.address_line_1)+" "+(null===e||void 0===e||null===(v=e.data)||void 0===v||null===(m=v.data)||void 0===m?void 0:m.address_line_2),city:null===e||void 0===e||null===(h=e.data)||void 0===h||null===(p=h.data)||void 0===p||null===(x=p.city)||void 0===x?void 0:x.city_name,price_Lable:null===e||void 0===e||null===(j=e.data)||void 0===j||null===(g=j.data)||void 0===g?void 0:g.price_Lable,state:null===e||void 0===e||null===(y=e.data)||void 0===y||null===(N=y.data)||void 0===N||null===(b=N.city)||void 0===b||null===(_=b.state)||void 0===_?void 0:_.state_name,banner:null===e||void 0===e||null===(f=e.data)||void 0===f||null===(w=f.data)||void 0===w||null===(A=w.banner)||void 0===A?void 0:A.url,Franchisee_Url:null===e||void 0===e||null===(I=e.data)||void 0===I||null===(C=I.data)||void 0===C?void 0:C.url};z({type:"addShippingInfo",payload:O}),r.Ay.success("Franchisee Added")}).catch(e=>{U(!1)})})(),children:"Add"})]})]}),null!==C&&(0,u.jsxs)("div",{className:"my-2",children:[(0,u.jsxs)("div",{className:"row",style:{fontSize:"14px"},children:[(0,u.jsx)("div",{className:"col-sm-4",children:(0,u.jsx)("img",{src:null===C||void 0===C?void 0:C.banner,alt:null===C||void 0===C?void 0:C.name,width:"100%"})}),(0,u.jsxs)("div",{className:"col-sm-8",children:[(0,u.jsx)("h6",{className:"m-0 ms-2",children:null===C||void 0===C?void 0:C.name}),(0,u.jsxs)("parent",{className:"m-0 ms-2 mt-3",children:["Address. : ",null===C||void 0===C?void 0:C.address]}),(0,u.jsxs)("p",{className:"m-0 ms-2 mt-1",children:["Contact No. : ",null===C||void 0===C?void 0:C.contact_Number]}),(0,u.jsxs)("p",{className:"m-0 ms-2 mt-1",children:["Contact Person Name :"," ",null===C||void 0===C?void 0:C.contact_Person_Name]}),(0,u.jsxs)("p",{className:"m-0 ms-2 mt-1",children:["Price Lable : ",null===C||void 0===C?void 0:C.price_Lable]}),(0,u.jsx)("button",{className:"btn btn-danger btn-sm ms-2 mt-2",onClick:()=>(e=>{z({type:"deleteFromshippingInfo",payload:{Franchisee:e}}),r.Ay.success("Franchisee Removed")})(null===C||void 0===C?void 0:C.id),children:"Delete"})]})]}),(0,u.jsx)("hr",{})]}),(0,u.jsx)("div",{className:"mt-3",children:(0,u.jsxs)("label",{children:[(0,u.jsx)("span",{className:"fw-bold",children:"Razorpay Order ID : "}),null===D||void 0===D?void 0:D.razorpay_order_id]})})," ",(0,u.jsx)("div",{className:"mt-1",children:(0,u.jsxs)("label",{children:[(0,u.jsx)("span",{className:"fw-bold",children:"Razorpay Payment ID : "}),null===D||void 0===D?void 0:D.razorpay_payment_id]})})]})})}),(0,u.jsxs)("div",{className:"col-lg-6 mt-3",children:[null!==C&&(0,u.jsx)("div",{className:"card",children:(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsxs)("div",{className:"mt-1",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Select Product:"}),(0,u.jsxs)("div",{className:"d-flex",children:[(0,u.jsxs)("select",{className:"form-control me-2",ref:S,children:[(0,u.jsx)("option",{value:"",children:"-----"}),D&&D.map((e,l)=>(0,u.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},l))]}),(0,u.jsx)("button",{className:"btn-sm btn-primary",onClick:e=>(async()=>{a.A.get("/api/product/getOne/".concat(S.current.value),{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(L)}}).then(e=>{var l,i,n,a,d,t,o,s,c,u,v;U(!1);const m=Object.keys(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.product),h=Object.values(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.product),p=m.indexOf(null===C||void 0===C?void 0:C.price_Lable),x=m.indexOf("".concat(null===C||void 0===C?void 0:C.price_Lable,"_With_Tax"));let j={name:null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.product)||void 0===a?void 0:a.name,price:h[p],product:null===e||void 0===e||null===(d=e.data)||void 0===d||null===(t=d.product)||void 0===t?void 0:t._id,quantity:1,image:null===e||void 0===e||null===(o=e.data)||void 0===o||null===(s=o.product)||void 0===s||null===(c=s.image)||void 0===c?void 0:c.url,taxId:null===e||void 0===e||null===(u=e.data)||void 0===u||null===(v=u.product)||void 0===v?void 0:v.taxId,price_With_Tax:h[x]};z({type:"addToCart",payload:j}),z({type:"calculatePrice"}),r.Ay.success("Product Added")}).catch(e=>{U(!1)})})(),children:"Add"})]})]}),(0,u.jsxs)("div",{className:"mt-2",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Product :"}),f&&f.map((e,l)=>{var i;return(0,u.jsxs)("div",{className:"my-2",children:[(0,u.jsxs)("div",{className:"row",style:{fontSize:"14px"},children:[(0,u.jsx)("div",{className:"col-sm-4",children:(0,u.jsx)("img",{src:null===e||void 0===e||null===(i=e.image[0])||void 0===i?void 0:i.url,alt:null===e||void 0===e?void 0:e.name,style:{width:"100%",objectFit:"contain",maxHeight:"150px"}})}),(0,u.jsxs)("div",{className:"col-sm-8",children:[(0,u.jsx)("h6",{className:"m-0 ms-2",children:null===e||void 0===e?void 0:e.name}),(0,u.jsxs)("div",{className:"row",children:[(0,u.jsxs)("div",{className:"col-sm-6",children:[(0,u.jsxs)("div",{className:"d-flex justify-content-center mt-3 me-3 ",style:{width:"6rem"},children:[(0,u.jsx)("button",{className:"btn btn-sm btn-primary ",onClick:()=>(e=>{z({type:"decrement",payload:{product:e}}),z({type:"calculatePrice"})})(null===e||void 0===e?void 0:e.product),children:"-"}),(0,u.jsx)("span",{className:"px-2 mt-1",style:{},children:null===e||void 0===e?void 0:e.quantity}),(0,u.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{z({type:"addToCart",payload:{product:e}}),z({type:"calculatePrice"})})(null===e||void 0===e?void 0:e.product),children:"+"})]}),(0,u.jsxs)("p",{className:"m-0 mt-3",children:[(0,u.jsx)("stong",{children:"Total Price:"})," $",(null===e||void 0===e?void 0:e.quantity)*(null===e||void 0===e?void 0:e.price)]}),(0,u.jsx)("button",{className:"btn btn-danger btn-sm ms-2 mt-3",onClick:()=>(e=>{z({type:"deleteFromCart",payload:{product:e}}),z({type:"calculatePrice"}),r.Ay.success("Item Removed")})(null===e||void 0===e?void 0:e.product),children:"Delete"})]}),(0,u.jsx)("div",{className:"col-sm-6",children:(0,u.jsxs)("p",{className:"m-0 mt-3",children:[(0,u.jsx)("stong",{children:" Price:"})," $",null===e||void 0===e?void 0:e.price]})})]})]})]}),(0,u.jsx)("hr",{})]})}),w&&(0,u.jsxs)("h5",{className:"m-0 contents-center mt-3",children:[(0,u.jsx)("span",{children:" Total Order Value:"})," \u20b9",w]})]})]})}),(0,u.jsx)("div",{className:"card my-1",children:(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsx)("label",{className:"fw-bold",children:"Status Timeline :"}),(0,u.jsx)("table",{className:"table table-info table-sm m-0",style:{borderRadius:"8px",borderCollapse:"collapse",overflow:"hidden"},children:(0,u.jsxs)("tbody",{children:[(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Order Placed On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(e=D.status_timeline)&&void 0!==e&&e.new?new Date(null===D||void 0===D||null===(l=D.status_timeline)||void 0===l?void 0:l.new).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):new Date(null===D||void 0===D?void 0:D.placed_on).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0})})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Processing Started"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(i=D.status_timeline)&&void 0!==i&&i.processing?new Date(null===D||void 0===D||null===(v=D.status_timeline)||void 0===v?void 0:v.processing).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Dispatched On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(m=D.status_timeline)&&void 0!==m&&m.dispatched?new Date(null===D||void 0===D||null===(h=D.status_timeline)||void 0===h?void 0:h.dispatched).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Delivered On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(p=D.status_timeline)&&void 0!==p&&p.delivered?new Date(null===D||void 0===D||null===(x=D.status_timeline)||void 0===x?void 0:x.delivered).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Cancelled On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(j=D.status_timeline)&&void 0!==j&&j.cancelled?new Date(null===D||void 0===D||null===(g=D.status_timeline)||void 0===g?void 0:g.cancelled).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]}),(0,u.jsxs)("tr",{className:"text-center",children:[(0,u.jsx)("th",{scope:"row",children:"Returned On"}),(0,u.jsx)("td",{children:" : "}),(0,u.jsx)("td",{children:null!==D&&void 0!==D&&null!==(y=D.status_timeline)&&void 0!==y&&y.returned?new Date(null===D||void 0===D||null===(N=D.status_timeline)||void 0===N?void 0:N.returned).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}):"-"})]})]})})]})})]})]})]})})}),(0,u.jsx)("div",{style:{display:"none"}})]})}}}]);