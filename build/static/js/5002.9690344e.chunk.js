"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[5002],{85002:function(e,r,d){d.r(r);var s=d(9950),t=d(26910),l=d(6536),c=d.n(l),a=d(11031),n=d(28429),i=d(35887),h=d(44414);r.default=()=>{const[e,r]=(0,s.useState)(null),[d,l]=(0,s.useState)(!1),[o,x]=(0,s.useState)([]),[u,j]=(0,s.useState)([]),[p,m]=(0,s.useState)([]),N=(0,n.Zp)();return(0,h.jsxs)("div",{className:"container mt-4",children:[(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsx)("button",{onClick:()=>N("/products"),className:"btn btn-secondary",children:"Back"})}),(0,h.jsx)("h5",{className:"mb-6 mt-4",children:"Add Multiple Products"}),(0,h.jsxs)("div",{className:"my-3",children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-lg-9",children:(0,h.jsx)("input",{type:"file",name:"file",className:"form-control",accept:".xlsx",onChange:e=>{const d=e.target.files[0];d&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===d.type?r(d):(c()("Error","Please upload a valid Excel file","error"),r(null))}})}),(0,h.jsx)("div",{className:"col-lg-3",children:(0,h.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(e){l(!0),x([]),j([]),m([]);try{const d=new FormData;d.append("file",e);const s=(0,a.g)(),l=await t.A.post("/api/products/upload",d,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(s)}}),{data:n}=l;n.errors&&n.errors.length>0&&x(n.errors),n.newlyCreated&&n.newlyCreated.length>0&&m(n.newlyCreated),n.updatedProducts&&n.updatedProducts.length>0&&j(n.updatedProducts),n.errors&&n.errors.length>0?(x(n.errors),c()({title:"SpreadSheet Upload Successful",text:"A few products have errors. Please fix them and upload again.",icon:"warning",button:"OK"})):n.updatedProducts&&n.updatedProducts.length>0||n.newlyCreated&&n.newlyCreated.length>0?c()({title:"SpreadSheet Upload Successful",text:"Products added successfully",icon:"success",button:"OK"}):(i.Ay.success("Products added successfully"),N("/products")),r(null),document.querySelector('input[type="file"]').value=""}catch(n){var d,s;console.error("Upload error:",n),c()("Error","Failed to upload products: ".concat((null===(d=n.response)||void 0===d||null===(s=d.data)||void 0===s?void 0:s.message)||"An unexpected error occurred"),"error")}finally{l(!1)}}else c()("Error","No file selected","error")},disabled:d,children:d?"Uploading...":"Upload"})})]}),(0,h.jsx)("p",{className:"pt-1 pl-2 text-secondary",children:"Upload only .xlsx files*"})]}),o.length>0&&(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("h6",{children:"Finding errors while adding the products."}),(0,h.jsxs)("table",{className:"table table-bordered",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Product Name"}),(0,h.jsx)("th",{children:"Category"}),(0,h.jsx)("th",{children:"Brand"}),(0,h.jsx)("th",{children:"GST"}),(0,h.jsx)("th",{children:"HSN_Code"}),(0,h.jsx)("th",{children:"price"}),(0,h.jsx)("th",{children:"Message"})]})}),(0,h.jsx)("tbody",{children:o.map((e,r)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:e.productName||"N/A"}),(0,h.jsx)("td",{children:e.category||"N/A"}),(0,h.jsx)("td",{children:e.brand||"N/A"}),(0,h.jsx)("td",{children:e.GST||"N/A"}),(0,h.jsx)("td",{children:e.HSN_Code||"N/A"}),(0,h.jsx)("td",{children:e.price||"N/A"}),(0,h.jsx)("td",{children:e.message})]},r))})]})]}),u.length>0&&(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("h6",{children:"Updated Product Details."}),(0,h.jsxs)("table",{className:"table table-bordered",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Product Name"}),(0,h.jsx)("th",{children:"Category"}),(0,h.jsx)("th",{children:"Brand"}),(0,h.jsx)("th",{children:"GST"}),(0,h.jsx)("th",{children:"HSN_Code"}),(0,h.jsx)("th",{children:"price"}),(0,h.jsx)("th",{children:"Message"})]})}),(0,h.jsx)("tbody",{children:u.map((e,r)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:e.name||"N/A"}),(0,h.jsx)("td",{children:e.category||"N/A"}),(0,h.jsx)("td",{children:e.brand||"N/A"}),(0,h.jsx)("td",{children:e.GST||"N/A"}),(0,h.jsx)("td",{children:e.HSN_Code||"N/A"}),(0,h.jsx)("td",{children:e.price||"N/A"}),(0,h.jsx)("td",{children:e.updatedFields})]},r))})]})]}),p.length>0&&(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("h6",{children:"Newly Created Product Details:"}),(0,h.jsxs)("table",{className:"table table-bordered",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Product Name"}),(0,h.jsx)("th",{children:"Category"}),(0,h.jsx)("th",{children:"Brand"}),(0,h.jsx)("th",{children:"GST"}),(0,h.jsx)("th",{children:"HSN_Code"}),(0,h.jsx)("th",{children:"price"})]})}),(0,h.jsx)("tbody",{children:p.map((e,r)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:e.name||"N/A"}),(0,h.jsx)("td",{children:e.category||"N/A"}),(0,h.jsx)("td",{children:e.brand||"N/A"}),(0,h.jsx)("td",{children:e.GST||"N/A"}),(0,h.jsx)("td",{children:e.HSN_Code||"N/A"}),(0,h.jsx)("td",{children:e.price||"N/A"})]},r))})]})]})]})}}}]);